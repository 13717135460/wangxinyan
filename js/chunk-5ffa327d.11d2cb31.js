(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5ffa327d"],{"00b4":function(e,t,r){"use strict";r("ac1f");var a=r("23e7"),n=r("c65b"),o=r("1626"),l=r("825a"),s=r("577e"),i=function(){var e=!1,t=/[ac]/;return t.exec=function(){return e=!0,/./.exec.apply(this,arguments)},!0===t.test("abc")&&e}(),c=/./.test;a({target:"RegExp",proto:!0,forced:!i},{test:function(e){var t=l(this),r=s(e),a=t.exec;if(!o(a))return n(c,t,r);var i=n(a,t,r);return null!==i&&(l(i),!0)}})},"02be":function(e,t,r){},"14d9":function(e,t,r){"use strict";var a=r("23e7"),n=r("7b0b"),o=r("07fa"),l=r("3a34"),s=r("3511"),i=r("d039"),c=i((function(){return 4294967297!==[].push.call({length:4294967296},1)})),u=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(e){return e instanceof TypeError}},d=c||!u();a({target:"Array",proto:!0,arity:1,forced:d},{push:function(e){var t=n(this),r=o(t),a=arguments.length;s(r+a);for(var i=0;i<a;i++)t[r]=arguments[i],r++;return l(t,r),r}})},3511:function(e,t){var r=TypeError,a=9007199254740991;e.exports=function(e){if(e>a)throw r("Maximum allowed index exceeded");return e}},"3a34":function(e,t,r){"use strict";var a=r("83ab"),n=r("e8b5"),o=TypeError,l=Object.getOwnPropertyDescriptor,s=a&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}();e.exports=s?function(e,t){if(n(e)&&!l(e,"length").writable)throw o("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t}},"7bb4":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"case-box excel-upload"},[t("h1",[e._v("excel-上传")]),t("upload-excel-component",{attrs:{"on-success":e.handleSuccess,"before-upload":e.beforeUpload}}),t("el-table",{staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:e.tableData,border:"","highlight-current-row":""}},e._l(e.tableHeader,(function(e){return t("el-table-column",{key:e,attrs:{prop:e,label:e}})})),1)],1)},n=[],o=function(){var e=this,t=e._self._c;return t("div",[t("input",{ref:"excel-upload-input",staticClass:"excel-upload-input",attrs:{type:"file",accept:".xlsx, .xls"},on:{change:e.handleClick}}),t("div",{staticClass:"drop",on:{drop:e.handleDrop,dragover:e.handleDragover,dragenter:e.handleDragover}},[e._v(" Drop excel file here or "),t("el-button",{staticStyle:{"margin-left":"16px"},attrs:{loading:e.loading,size:"mini",type:"primary"},on:{click:e.handleUpload}},[e._v("上传表格")])],1)])},l=[],s=(r("d3b7"),r("14d9"),r("ac1f"),r("00b4"),r("b0c0"),r("1146")),i=r.n(s),c={props:{beforeUpload:Function,onSuccess:Function},data:function(){return{loading:!1,excelData:{header:null,results:null}}},methods:{generateData:function(e){var t=e.header,r=e.results;this.excelData.header=t,this.excelData.results=r,this.onSuccess&&this.onSuccess(this.excelData)},handleDrop:function(e){if(e.stopPropagation(),e.preventDefault(),!this.loading){var t=e.dataTransfer.files;if(1===t.length){var r=t[0];if(!this.isExcel(r))return this.$message.error("Only supports upload .xlsx, .xls, .csv suffix files"),!1;this.upload(r),e.stopPropagation(),e.preventDefault()}else this.$message.error("Only support uploading one file!")}},handleDragover:function(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"},handleUpload:function(){this.$refs["excel-upload-input"].click()},handleClick:function(e){var t=e.target.files,r=t[0];r&&this.upload(r)},upload:function(e){if(this.$refs["excel-upload-input"].value=null,this.beforeUpload){var t=this.beforeUpload(e);t&&this.readerData(e)}else this.readerData(e)},readerData:function(e){var t=this;return this.loading=!0,new Promise((function(r,a){var n=new FileReader;n.onload=function(e){var a=e.target.result,n=i.a.read(a,{type:"array"}),o=n.SheetNames[0],l=n.Sheets[o],s=t.getHeaderRow(l),c=i.a.utils.sheet_to_json(l);t.generateData({header:s,results:c}),t.loading=!1,r()},n.readAsArrayBuffer(e)}))},getHeaderRow:function(e){var t,r=[],a=i.a.utils.decode_range(e["!ref"]),n=a.s.r;for(t=a.s.c;t<=a.e.c;++t){var o=e[i.a.utils.encode_cell({c:t,r:n})],l="UNKNOWN "+t;o&&o.t&&(l=i.a.utils.format_cell(o)),r.push(l)}return r},isExcel:function(e){return/\.(xlsx|xls|csv)$/.test(e.name)}}},u=c,d=(r("d050"),r("2877")),f=Object(d["a"])(u,o,l,!1,null,"92c13b0e",null),p=f.exports,h={name:"excel-upload",data:function(){return{tableData:[],tableHeader:[]}},components:{UploadExcelComponent:p},methods:{beforeUpload:function(e){var t=e.size/1024/1024<1;return!!t||(this.$message({message:"Please do not upload files larger than 1m in size.",type:"warning"}),!1)},handleSuccess:function(e){var t=e.results,r=e.header;this.tableData=t,this.tableHeader=r}}},g=h,b=(r("d545"),Object(d["a"])(g,a,n,!1,null,"3c286332",null));t["default"]=b.exports},d050:function(e,t,r){"use strict";r("e431")},d545:function(e,t,r){"use strict";r("02be")},e431:function(e,t,r){}}]);
//# sourceMappingURL=chunk-5ffa327d.11d2cb31.js.map